<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>üè≥Ô∏è‚Äçüåà Que dit ce compte sur les personnes LGBTQIAA+ ?</title>
        <link
          rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/choices.js@9.0.1/public/assets/styles/choices.min.css"
        />
        <style>
            :root {
                --white: #FFF;
                --blue-twitter: #0084B4;
                --blue-dark: #091D34;
                --yellow: #F8CE90;
                /* Credits : http://barchok.com/flags.html */
                --flag: linear-gradient(-120deg, #FE0000 16.66%,
                #FD8C00 16.66%, 33.32%,
                #FFE500 33.32%, 49.98%,
                #119F0B 49.98%, 66.64%,
                #0644B3 66.64%, 83.3%,
                #C22EDC 83.3%);
                --ease: all .3s ease;
            }
            html, body, main {
                width: 100%;
                height: 100vh;
            }

            html, body {
                padding: 0;
                margin: 0;
                color: var( --blue-twitter );
                background-color: var( --blue-dark );
                font-family: sans-serif;
                font-size: 16px;
                overflow: hidden;
            }

            *, *::before, *::after { box-sizing: border-box; }

            main {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }

            main::before {
                width: 100%;
                height: 100%;
                position: fixed;
                content: '';
                display: block;
                top: 0;
                left: 0;
                background: var( --flag );
                opacity: .15;
            }

            h1 {
                display: block;
                margin: 1rem;
                font-size: 2rem;
                color: var( --white );
            }

            form {
                width: 25rem;
                padding: 2rem;
                position: relative;
                display: block;
                text-align: center;
            }

            select {
                width: 100%;
                text-align: left;
            }

            .sidebar {
                width: 100%;
                max-width: 20rem;
                height: 100vh;
                position: fixed;
                top: 0;
                right: -100%;
                z-index: 2;
                overflow: hidden;
                margin: 0;
                padding: 2rem 1rem;
                background: var( --yellow );
                transition: var( --ease );
            }

            .sidebar.is-open {
                right: 0;
            }

            .choices .choices__list,
            .choices .choices__inner {
                background: none;
                border: none;
                text-align: left;
            }

            .choices .choices__item,
            [data-type*=select-multiple].choices button.choices__button {
                color: var( --twitter );
                border: none;
            }

            .choices .choices__item {
                background: var( --white );
            }

            [data-type*=select-multiple].choices button.choices__button {
                filter: invert( 1 );
            }

            [type="search"] {
                width: 100%;
                margin: 1rem 0;
                padding: 1rem 2rem;
                outline: none;
                appearance: none;
                border: none;
                background: none;
                border-bottom: 2px solid var( --blue-twitter );
                font-size: 2rem;
                line-height: 1.5;
                transition: var( --ease );
            }

            ::-ms-clear { display:none; }

            [type="search"]:focus,
            [type="search"]:active {
                border-bottom-color: var( --white );
            }

            label,
            input,
            input::placeholder {
                opacity: 1;
                color: var( --white );
            }

            button {
                appearance: none;
                outline: none;
                border: none;
                background: none;
            }

            button[type="submit"] {
                margin: 0 auto;
                padding: 1rem 2rem;
                background: var( --white );
                border-radius: 2rem;
                text-transform: uppercase;
                transition: var( --ease );
                cursor: pointer;
            }

            button[type="submit"]:hover {
                color: var( --white );
                background: var( --blue-twitter );
            }

            .sidebar__toggle {
                position: fixed;
                top: 0;
                right: 0;
                z-index: 1;
                padding: 1rem;
                color: var( --white );
                font-size: 2rem;
            }

        </style>
    </head>
    <body>
        <main>
            <h1>Que dit ce compte sur les personnes LGBTQIAA+ ?</h1>
            <form method="GET">
                <input
                    type="search"
                    name="user"
                    id="user"
                    autocomplete="off"
                    autocorrect="off"
                    autocapitalize="off"
                    spellcheck="false"
                    placeholder="@pseudo"
                    required=""
                >
                <menu class="sidebar js-sidebar" aria-hidden="true">

                    <select name="words[]" class="js-choice" multiple="multiple"></select>

                    <label>
                        <input name="scheme" type="checkbox" checked/>
                        @TODO Ouvrir dans l'application Twitter si install√©e
                    </label>

                </menu>

                <button type="submit">Afficher</button>
            </form>
            <button class="sidebar__toggle js-sidebar__toggle" title="Options">‚öôÔ∏è</button>
        </main>

        <script src="https://cdn.jsdelivr.net/npm/choices.js@9.0.1/public/assets/scripts/choices.min.js"></script>
        <script>
            const words = [
                'homosexualit√©',
                'gays',
                'lesbianisme',
                'lesbienne',
                'transgenre',
                'transphobe',
                'transsexuel',
                'transsexuelle',
                'transidentit√©',
                'trav',
                'trap',
                'travlo',
                'travelo',
                'goudou',
                'tantouze',
                'inverti',
                'gaypride',
                'homophobe',
                'homophobie',
                'PD',
                'homos',
                'tapette',
                'fiotte',
                'p√©d√©',
                'encul√©',
                'p√©do',
                '"lobby+lgbt"'
            ];

            const buildUrl = ( user, words, is_scheme ) => {

                let q = words.join(" OR ").replace(/\+/g," "),
                val = user.trim().replace( /\u202A/g,"" ).replace( /\u202C/g,"" ),
                scheme = is_scheme == 'on' ? 'https://twitter.com' : 'https://twitter.com';
                // Add @ if missing
                val = val.charAt( 0 ) == '@' ? val : `@${val}`;
                return `${scheme}/search?q=${encodeURIComponent(`${q} from:${val}`)}`;
            }

            const addOptions = (  ) => {
                let select = document.querySelector( 'select' );

                if( !select ) return;

                words.forEach( ( word ) => {
                    let option = document.createElement( 'option' );
                    option.value = word;
                    option.setAttribute( 'selected', true );
                    option.textContent = word.charAt(0).toUpperCase() + word.slice(1);
                    select.appendChild( option );
                } );

                // Pass single element
                const element = document.querySelector('.js-choice');
                const choices = new Choices( element, {
                    removeItems: true,
                    removeItemButton: true,
                    addItems: true,
                    addItemText: (value) => {
                     return `Press Enter to add <b>"${value}"</b>`;
                   },
                } );
            }

            window.addEventListener( 'load', () => {
                // Add dynamicaly the options
                addOptions();

                document.querySelector( 'form' ).addEventListener( 'submit', ( e ) => {
                    e.preventDefault();

                    let datas = new FormData( e.target );

                    if( datas.get( 'user' ) )
                        location.href = buildUrl( datas.get( 'user' ), datas.getAll( 'words[]' ), datas.get( 'scheme' ) );

                    return false;

                }, false );

                document.querySelector( '.js-sidebar__toggle' ).addEventListener( 'click', ( e ) => {
                    e.preventDefault();

                    let sidebar = document.querySelector( '.js-sidebar' );
                    sidebar.classList.toggle( 'is-open' );
                    sidebar.toggleAttribute( 'aria-hidden' );

                }, false );
            }, false );

        </script>
    </body>
</html>
